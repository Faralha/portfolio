---
import { getCollection } from 'astro:content'
import BaseLayout from '@/layouts/BaseLayout.astro'
import siteConfig from '@/site-config'
import TechStackCarousel from '@/components/TechStackCarousel.vue'
import ProjectHighlights from '@/components/ProjectHighlights.vue'

// Define project slugs to highlight (cuma slug saja!)
const highlightedProjectSlugs = [
  'web-development/hcq-lms',
  'web-development/hmtc-2025',
  'web-development/alterkai-monolithic',
  'web-development/tropicasweets',
  // Tambahkan slug project lain di sini
]

// Fetch all projects
const allProjects = await getCollection('projects', ({ data }) => data.draft !== true)

// Get highlighted projects data based on slugs
const highlightedProjects = highlightedProjectSlugs
  .map((slug) => {
    const project = allProjects.find((p) => p.slug === slug)
    if (!project) return null

    return {
      text: project.data.title,
      description: project.data.description,
      href: `/projects/${project.slug}`,
      tags: project.data.tags,
    }
  })
  .filter((p) => p !== null) // Remove projects that weren't found
---

<BaseLayout description={siteConfig.description}>
  <article class="prose">
    <!-- Introduction and Hero -->
    <h1>
      Crafting <span class="text-blue">scalable</span> backends with NestJS,
      <span class="text-blue">reactive</span> frontends with Vue, and <span class="text-blue">automated</span> deployments
      with Docker.
    </h1>
    <p>
      Hi, nice to meet you! My name is <span class="text-blue text-2xl font-semibold">Muhammad Zufar Al Hafidz</span>. I
      specialize in building <span class="text-blue font-semibold">fullstack</span> applications and <span
        class="text-blue font-semibold">deployments</span
      >
      (CI/CD). Read more about me at <a href="/about">About Me</a>.
    </p>

    <!-- Skillset -->
    <TechStackCarousel client:load />
  </article>

  <!-- Project Highlights (outside prose) -->
  <div class="mb-16">
    <h2 class="text-3xl font-bold mb-6">Project Highlights</h2>
    <ProjectHighlights projects={highlightedProjects} client:load />
    <p class="text-center mt-6">
      <a href="/projects" class="text-blue hover:underline">View all projects â†’</a>
    </p>
  </div>

  <article class="prose">
    <!-- Contacts -->
    <hr class="hr-line" />
    <h2>Contacts</h2>
    <p>Want to get in touch? Find me on</p>
    <p class="flex gap-x-4 gap-y-2 flex-wrap">
      {
        siteConfig.socialLinks.map((link) => (
          <a aria-label={link.text} href={link.href} target="_blank" class="prose-link">
            <i class:list={[link.icon]} />
            {link.text}
          </a>
        ))
      }
    </p>
    <p>I always welcome any opportunities to collaborate or chat!</p>
  </article>
</BaseLayout>
